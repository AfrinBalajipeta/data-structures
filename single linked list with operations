//wap to create single linked list
#include<stdio.h>
#include<stdlib.h>
struct node
{
	int data;
	struct node*next;
} *head=NULL;
void createlinkedlist()
{
	struct node*temp,*ptr;
	temp=(struct node*)malloc(sizeof(struct node));
	temp->next=NULL;
	printf("\n enter data value in node:");
	scanf("%d",&temp->data);
	if(head==NULL)
	{
		head=temp;
	}
	else
	{
		ptr=head;
		while(ptr->next!=NULL)
		{
			ptr=ptr->next;
		}
		ptr->next=temp;
	}
}
void displaylinkedlist()
{
	struct node *ptr;
	ptr=head;
	if(ptr==NULL)
	{
		printf("\n linked list is empty");
	}
	else
	{
		while(ptr!=NULL)
		{
			printf("%d->",ptr->data);
			ptr=ptr->next;
		}
		printf("NULL");
	}
}
void firstinsert()
{
	struct node*temp;
	temp=(struct node*)malloc(sizeof(struct node));
	temp->next=NULL;
	printf("\n enter data in first node:");
	scanf("%d",&temp->data);
	temp->next=head;
	head=temp;
    printf("\n insert at first node successful");
}
void lastinsert()
{
	struct node *temp,*ptr;
	temp=(struct node*)malloc(sizeof(struct node));
	temp->next=NULL;
	printf("\n enter data in last node:");
	scanf("%d",&temp->data);
	ptr=head;
	while(ptr->next!=NULL)
	{
		ptr=ptr->next;
	}
	ptr->next=temp;
	printf("added node at last of linkedlist successful");
}
void firstdelete()
{
	struct node*ptr;
	ptr=head;
	head=ptr->next;
	free(ptr);
	printf("\n deleted first node successfully");
}
void lastdelete()
{
	struct node *ptr,*temp;
	ptr=head; 
	while(ptr->next->next!=NULL)
	{
		ptr=ptr->next;
	}
	ptr->next=NULL;
	free(temp);
	printf("\n deleted last node successfully");
}
void anypos_insert()
{
	int pos,count=0;
	struct node *temp,*ptr;
	if(head==NULL)
	{
		printf("\n linkedlist is empty");
	}
	while(ptr!=NULL)
	{
		count++;
		ptr=ptr->next;
	}
	temp=(struct node*)malloc(sizeof(struct node));
	temp->next=NULL;
	printf("\nEnter the data:");
	scanf("%d",&temp->data);
	printf("enter the position:");
	scanf("%d",&pos);
	if(pos<1||pos>count+1)
	{
		printf("\nInvalid pos");
	}
	else
	{
		ptr=head;
		if(pos==1)
		{
			temp->next=head;
			head=temp;
			printf("\n insertion at anypos first is successful");
		}
		else
		{
			ptr=head;
			int i;
			for(i=1;i<pos-1;i++)
			{
				ptr=ptr->next;
			}
			temp->next=ptr->next;
			ptr->next=temp;
			printf("\n insertion at anypos is successful");
		}
	}
}
void anypos_delete()
{
	int pos,count=0;
	struct node*temp,*ptr;
	ptr=head;
	while(ptr!=NULL)
	{
		count++;
		ptr=ptr->next;
	}
	printf("Enter position:");
	scanf("%d",&pos);
	if(pos<1||pos>count)
	{
		printf("\n Invalid position");
	}
	else
	{
		ptr=head;
		if(pos==1)
		{
			head=ptr->next;
			printf("\n%d first node is deleted successfully!!",ptr->data);
			free(ptr);
		}
		else
		{
			int i;
			for(int i=1;i<pos-1;i++)
			{
				ptr=ptr->next;
			}
			temp=ptr->next;
			ptr->next=temp->next;
			printf("\n%d anypos deletion is successful",temp->data);
			free(temp);
		}
	}
}
void sum_elements()
{
	int sum=0;
	struct node *ptr;
	ptr=head;
	if(head==NULL)
	{
		printf("\n linkedlist is empty");
	}
	else
	{
		while(ptr!=NULL)
		{
			sum=sum+ptr->data;
			ptr=ptr->next;
		}
		printf("\n sum is %d",sum);
	}
}
void print_alternate()
{
	struct node *ptr;
	ptr=head;
	while(ptr!=NULL)
	{
		printf("%d\t",ptr->data);
		if(ptr->next==NULL)
		{
			ptr=ptr->next;
		}
		else
		{
		ptr=ptr->next->next;
	    }
	}
}
void reversesll()
{
	struct node*pn,*cn;
	pn=head;
	head=head->next;
	cn=head;
	pn->next=NULL;
	while(head!=NULL)
	{
		head=head->next;
		cn->next=pn;
		pn=cn;
		cn=head;
	}
	head=pn;
	struct node*temp;
	while(temp!=NULL)
	{
		printf("%d",temp);
		temp=temp->next;
	}
}
int main()
{
	int ch;
	while(1)
	{
		printf("\n1.createlinkedlist \n2.display \n3.first_insert \n4.lastinsert \n5.firstdelete \n6.lastdelete \n7.anypos_insert \n8.anypos_delete \n9.sum_elements \n10.print_alternate \n11.reversesll \n12.exit \n enter your choice:");
		scanf("%d",&ch);
		if(ch==1)
		createlinkedlist();
	    else if(ch==2)
	    displaylinkedlist();
	    else if(ch==3)
	    firstinsert();
	    else if(ch==4)
	    lastinsert();
	    else if(ch==5)
	    firstdelete();
	    else if(ch==6)
	    lastdelete();
	    else if(ch==7)
	    anypos_insert();
	    else if(ch==8)
	    anypos_delete();
	    else if(ch==9)
	    sum_elements();
	    else if(ch==10)
	    print_alternate();
	    else if(ch==11)
	    reversesll();
	    else if(ch==12)
	    break;
	    else
	    printf("wrong choice entered");
	}
}
